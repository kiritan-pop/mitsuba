# mitsuba
## はじめに
ミツバサンコーワのバイク用ドラレコEDR-21で作成した動画を結合します。このドラレコは30秒毎にファイルが作成されますが、0.5秒程度の重複があり単純に結合できません。重複を削除しつつ結合するためのツールです。
音声も結合します。EDR-21で作成された動画で確認していますが、EDR-11もEDR-21Gも問題ないと思います。

## 前提
- python3.7以上の実行環境
- ffmpeg
- ffmpegが動けばOSはどれでも大丈夫なはずです。（OS X,ubuntuで動作確認済みです）

## 使い方
- ```config_sample.py``` を コピーして ```config.py``` を作ります。
- mitsuba.py と同じディレクトリに ```in/``` ディレクトリを作成し、結合したいファイルを入れます。
- ```python mitsuba.py``` コマンドで実行します
- ```out/``` ディレクトリの中に結合した動画ファイルが作成されます

## 仕様
- 出力される動画ファイルは mp4 です
- 各分割動画ファイル間での重複は14フレーム（0.5秒）として、結合時に削除しています
- 単純に１ファイルに結合せず、フロント・リア✕撮影開始時刻単位に結合します
- ビットレートは解像度に応じて固定にしています（FHD:11Mbps HD:6Mbps VGA:3Mbps）

## その他
- ```config.py``` でいくつか設定を変更することができます。
- ffmpeg をコマンドで実行しているので、ffmpeg のパラメータはお好みで修正すると良いと思います
- ソースコード上にffmpegのビデオフィルタの例をコメントしていますのでご参考まで（画質をややソフト・彩度アップ・ノイズ除去等）